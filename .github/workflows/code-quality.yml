name: Code Quality

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  code-quality:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    - name: Set up Go
      uses: actions/setup-go@v3
      with:
        go-version: 1.21

    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: 18

    - name: Install quality tools
      run: |
        go install golang.org/x/lint/golint@latest
        go install honnef.co/go/tools/cmd/staticcheck@latest
        npm install -g eslint

    - name: Run Go fmt
      run: |
        echo "Running Go fmt..."
        cd rechain-ide
        go fmt ./...

    - name: Run Go vet
      run: |
        echo "Running Go vet..."
        cd rechain-ide
        go vet ./...

    - name: Run Go lint
      run: |
        echo "Running Go lint..."
        cd rechain-ide
        golint ./...

    - name: Run Go staticcheck
      run: |
        echo "Running Go staticcheck..."
        cd rechain-ide
        staticcheck ./...

    - name: Run TypeScript lint
      run: |
        echo "Running TypeScript lint..."
        cd rechain-ide/vscode-extension/extension
        npx eslint src/**/*.ts